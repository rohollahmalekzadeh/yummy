import Head from 'next/head'
import {
  Banner,
  CategoryPoster,
  Row,
  MapComponent,
  RowsContainer,
  OrderPoster,
} from 'components'
import {getFooDData} from 'network/food-api/order-list'
import {
  DIET_MENU,
  DIET_QUERY,
  FOOD_MENU,
  FOOD_QUERY,
  MEAL_MENU,
  MEAL_QUERY,
  CATEGORY_MENU,
} from 'network/food-api/config'
import {normalizeDataForPoster} from 'utils/utils'

//! I'm going to change this
export async function getStaticProps() {
  const highProtein = await getFooDData(DIET_QUERY)(DIET_MENU.HIGH_PROTEIN)

  const highProteinList = normalizeDataForPoster(highProtein, {
    sliceFrom: 0,
    sliceTo: 20,
  }).filter((item: any) => item.off > 0 && item.price > 0)

  return {
    props: {
      highProteinList: {items: [...highProteinList], title: highProtein.title},
    },
  }
}

const Home = ({highProteinList}: any) => {
  return (
    <div>
      <Head>
        <title>Yummy</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/assets/logo2.jpg" />
      </Head>
      <div className="mb-20">
        <Banner />
      </div>

      <RowsContainer>
        <Row
          title="Category"
          classname={`${
            CATEGORY_MENU.length < 4
              ? `xl:grid-cols-${CATEGORY_MENU.length}`
              : ''
          }`}
        >
          <MapComponent Component={CategoryPoster} data={CATEGORY_MENU} />
        </Row>
        <Row
          title="Hot price"
          classname={`${
            highProteinList.items.length < 4
              ? `xl:grid-cols-${highProteinList.items.length}`
              : ''
          }`}
        >
          <MapComponent Component={OrderPoster} data={highProteinList.items} />
        </Row>
      </RowsContainer>
    </div>
  )
}

export default Home
